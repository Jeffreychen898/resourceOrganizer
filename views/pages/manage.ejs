<!DOCTYPE html>
<html>
	<head>
		<title>Append</title>
	</head>
	<body>
		<% for(let item of items) { %>

		<div><%= item.title %> <button data-id="<%= item.id %>" onclick="removeItem(this)">Remove</button></div>
		
		<% } %>
		<% if(messages.error) { %>
			<%= messages.error %>
		<% } %>
		<form action="/manage" method="POST">
			<p>Title <input name="title" required/></p>
			<p>url <input name="url" required/></p>
			<input type="hidden" value="<%= csrfToken %>" name="_csrf"/>
			<button type="submit">Submit</button>
		</form>
		<script>
			function removeItem(element) {
				const xhr = new XMLHttpRequest();
				xhr.onload = () => {
					console.log(xhr);
				}
				xhr.open("POST", "/manage/remove", true);
				xhr.setRequestHeader("Content-Type", "application/json");
				xhr.send(JSON.stringify({_csrf: "<%= csrfToken %>", id: element.getAttribute("data-id")}));
			}
		</script>
	</body>
</html>
